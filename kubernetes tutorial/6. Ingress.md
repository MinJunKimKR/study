# 인그레스

인그레스는 주로 클러스터 외부에서 안에 있는 파드에 접근할 때 사용하는 방법이다. 서비스와의 차이점은 주로 L7 영역의 통신을 담당해서 처리한다는 것이다. 

## 인그레스의 개념

인그레스는 클러스터 외부에서 안으로 접근하는 요청들을 어떻게 처리할지 정의해둔 규칙 모음이다. 클러스터 외부에서 접근해야 할지 정의해둔 규칙의 모음이다. 클러스터 외부에서 접근해야
할 URL을 사용할 수 있도록 하고, 트래픽 로드밸런싱, SSL 인증서 처리, 도메인 기반 가상 호스팅도 제공한다. 인그레스 자체는 이런 규칙들을 정의해둔
자원이고, 실제로 동작시키는 것은 인그레스 컨트롤러이다.  

직접 쿠버네티스 클러스터를 구축해서 사용하는 경우, 인그레스 컨트롤러를 직접 인그레스와 연동해야 한다. 이때 가장 많이 사용하는 도구는 쿠버네티스에서 제공하는 ingress-nginx이다. ingress-nginx 컨트롤러는 인그레스에 설정한 내용을 nginx 환경설정으로 변경하여 nginx에 적용한다.  

인그레스 설정의 예는 아래와 같다.  

~~~
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: test
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /    # 1
  spec:
    rules:
    - host: foo.bar.com                              # 2
      http:
      paths:
      - path: /foos1
        backend:
          serviceName: s1
          servicePort: 80                    
      - path: /bars2                          
        backend:
          serviceName: s2
          servicePort: 80
    - host: bar.foo.com                               # 3
      http:
        paths:
        - backend:
            serviceName: s2
            servicePort: 80
 ~~~
 
 
   

